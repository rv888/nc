<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="lightning" content="lnurlp:gamemasters@getalby.com"/>
    <link rel="icon" href="https://gamemasters.social/images/icon.png" sizes="192x192" />
    <meta name="description" content="Christmas is a time of giving back to the community">
    <meta property="og:description" content="Christmas is a time of giving back to the community">
    <meta name="keywords" content="nostr, christmas, bitcoin">
    <meta property="og:image" content="https://i.nostr.build/dlyY.png">

    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.nostr.christmas">
    <link rel="canonical" href="https://www.nostr.christmas">
    <meta property="og:site_name" content="Nostr Christmas: A Time of Giving">

    <title>Nostr Christmas: A Time of Giving</title>
    <meta property="og:title" content="Nostr Christmas: A Time of Giving">
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            background-color: black;
        }
        header,
        section,
        footer {
            color: white;
        }

        .btn-purple {
            background-color: purple;
            color: white;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.25rem;
            text-decoration: none;
            margin: 0.5rem;
        }

        .hero {
            position: relative;
            overflow: hidden;
        }

        .hero img {
            width: 100%;
            height: 75vh;
            object-fit: cover;
        }

        .hero-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: white;
        }

        .hero-text h1 {
            font-size: 400%;
            text-shadow: 2px 2px 4px #000;
        }

        h2 {
            font-size: 175%;
        }

        footer {
            background-color: #000;
        }
        .image-column {
            width: 30%;
            max-width: 30%;
        }
        .image-column img {
            width: 100%;
            height: auto;
        }
        .table{
            color: #fff;
        }
        .winner_count {
            font-size: 1.2rem;
        }
        .active-link {
            text-decoration: underline;
            font-weight: bold;
        }
        .durations {
            font-size: 80%;
            font-weight: normal;
            float: right;
        }
        a {
            color: #dcdcdc;
        }
        a:hover{
            color: #dc1fdc;
        }
        .feathered-box {
            background: linear-gradient(135deg, transparent 10px, #000 0),
            linear-gradient(225deg, transparent 10px, #000 0),
            linear-gradient(315deg, transparent 10px, #000 0),
            linear-gradient(45deg, transparent 10px, #000 0);
            background-size: 100% 100%, 100% 100%, 100% 100%, 100% 100%;
            background-position: top left, top right, bottom right, bottom left;
            border-radius: 25px; /* Adjust the value as needed */
            padding: 20px;
            color: #fff;
        }
        .col-sm-4 {
            margin: 6px;
        }
        .col-sm-5 {
            margin: 6px;
        }
        .col-12 {
            margin: 3px;
        }
    </style>
</head>

<body>

<!-- Hero image with overlaid text -->
<div class="hero">
    <img src="https://i.nostr.build/dlyY.png" alt="Hero" class="img-fluid">
    <div class="hero-text">
        <h1 class="display-4 font-weight-bold">Nostr Christmas</h1>
        <p>Giving back to the Nostr community</p>
    </div>
</div>

<section class="bg-dark py-4">
    <div class="container mt-4">
        <div class="row">
            <div class="col-12">
                <h2>Riddles</h2>
                <p>Answer the riddles and plant their seeds. 12 riddles for 12 days of Christmas. 1 winner. Keep track of your 12 answers and write them down.</p>
                <p>Hint 1: What can have 12 words?</p>
            </div>

        </div>
        <div class="row" id="messages">


        </div>

    </div>
</section>

<!-- Footer -->
<footer class="text-center py-2">
    &nbsp;
</footer>

<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
<script src="https://unpkg.com/nostr-tools/lib/nostr.bundle.js"></script>

<script>

    let relays = ['wss://relay.damus.io', 'wss://relay.snort.social',"wss://relayable.org",
        "wss://nostr.mutinywallet.com",
        "wss://relay.primal.net"];
    const pool = new window.NostrTools.SimplePool();
    let cTimer, emessages = [];
    function get_messages(pk){
        //var pubKey = window.NostrTools.nip19.npubEncode(pk);

        let sub = pool.sub(
            [...relays],
            [
                {
                    kinds: [1],
                    authors: [pk],
                    since: Math.round(Date.now() / 1000) - (60 * 60 * 24 * 3),
                },
            ],
        )
        sub.on('event', event => {

            if (! emessages.includes(event.id)) {

                if (event.tags.length < 1){

                    console.log("init", event);

                    emessages.push(event.id);

                    create_div(event);
                }

            }
        })
        sub.on('eose', () => {
            sub.unsub()
        })

    }

    function create_div(event){

        let table = document.getElementById('messages'),
            row = document.createElement('div');
        row.classList.add('feathered-box');
        row.classList.add('col-12');
        row.classList.add('col-sm-5');
        row.dataset.created = event.created_at;

        row.innerHTML = event.content;
        table.appendChild(row);

        clearTimeout(cTimer);
        runTimer();
    }

    function runTimer(){
        cTimer = setTimeout(() => {
            sortTable();
        }, 3000);
    }

    function sortTable() {
        console.log("sortTable1");
        const parentContainer = document.getElementById('messages');
        const divElements = document.querySelectorAll('div[data-created]');

        // Convert NodeList to Array and sort by timestamp
        const sortedDivs = Array.from(divElements).sort((a, b) => {
            const timestampA = Date.parse(a.getAttribute('data-created'));
            const timestampB = Date.parse(b.getAttribute('data-created'));
            return timestampA - timestampB;
        });

        // Append sorted divs to the parent container
        sortedDivs.forEach(div => parentContainer.appendChild(div));
    }


    get_messages("97bb0f7908b21ab45516150d70c35f43954d13256b237b74a52346a4b5083123");

    runTimer();


</script>


</body>

</html>
